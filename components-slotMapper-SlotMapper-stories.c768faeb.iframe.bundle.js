"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[415],{"./src/components/slotMapper/SlotMapper.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>SlotMapper_stories});var react=__webpack_require__("./node_modules/react/index.js"),Labware=__webpack_require__("./src/components/labware/Labware.tsx"),Pager=__webpack_require__("./src/components/pagination/Pager.tsx");let SlotCopyMode=function(SlotCopyMode){return SlotCopyMode.ONE_TO_ONE="One to one",SlotCopyMode.ONE_TO_MANY="One to many",SlotCopyMode.MANY_TO_ONE="Many to one",SlotCopyMode}({});function usePrevious(value){const ref=(0,react.useRef)();return(0,react.useEffect)((()=>{ref.current=value}),[value]),ref.current}var WhiteButton=__webpack_require__("./src/components/buttons/WhiteButton.tsx"),LabwareScanner=__webpack_require__("./src/components/labwareScanner/LabwareScanner.tsx"),RemoveButton=__webpack_require__("./src/components/buttons/RemoveButton.tsx"),Table=__webpack_require__("./src/components/Table.tsx"),labwareColumns=__webpack_require__("./src/components/dataTableColumns/labwareColumns.tsx"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");function SlotMapperTable(_ref){let{labware,slots,slotCopyContent}=_ref;const mappingForSlots=react.useMemo((()=>{const mappingsForInputSlots=[];if(slots.length>0)slots.forEach((slot=>{const mappings=slotCopyContent.filter((scc=>scc.sourceBarcode===labware.barcode&&scc.sourceAddress===slot.address));mappings.length>0?mappings.forEach((scc=>{mappingsForInputSlots.push({slot,destinationAddress:scc.destinationAddress})})):mappingsForInputSlots.push({slot,destinationAddress:"-"})}));else{slotCopyContent.filter((scc=>scc.sourceBarcode===labware.barcode)).forEach((scc=>{const slot=labware.slots.find((slot=>slot.address===scc.sourceAddress));slot&&mappingsForInputSlots.push({slot,destinationAddress:scc.destinationAddress})}))}return mappingsForInputSlots}),[labware,slots,slotCopyContent]);return(0,jsx_runtime.jsxs)(Table.Ay,{"data-testid":"mapping_table",children:[(0,jsx_runtime.jsx)(Table.nd,{children:(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)(Table.A0,{children:"Source Barcode"}),(0,jsx_runtime.jsx)(Table.A0,{children:"Source Address"}),(0,jsx_runtime.jsx)(Table.A0,{children:"External Name"}),(0,jsx_runtime.jsx)(Table.A0,{children:"Spatial Location"}),(0,jsx_runtime.jsx)(Table.A0,{children:"Tissue Type"}),(0,jsx_runtime.jsx)(Table.A0,{children:"Replicate Number"}),(0,jsx_runtime.jsx)(Table.A0,{children:"Sections Number(s)"}),(0,jsx_runtime.jsx)(Table.A0,{children:"Destination Address"})]})}),(0,jsx_runtime.jsx)(Table.BF,{children:mappingForSlots.map((_ref2=>{let{slot,destinationAddress}=_ref2;return(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)(Table.nA,{children:labware.flagged?(0,labwareColumns.RF)(labware.barcode):labware.barcode}),(0,jsx_runtime.jsx)(Table.nA,{children:slot.address}),(0,jsx_runtime.jsx)(Table.nA,{children:slot.samples.length>0?slot.samples[0].tissue.externalName:""}),(0,jsx_runtime.jsx)(Table.nA,{children:slot.samples.length>0?slot.samples[0].tissue.spatialLocation.code:""}),(0,jsx_runtime.jsx)(Table.nA,{children:slot.samples.length>0?slot.samples[0].tissue.spatialLocation.tissueType.name:""}),(0,jsx_runtime.jsx)(Table.nA,{children:slot.samples.length>0?slot.samples[0].tissue.replicate:""}),(0,jsx_runtime.jsx)(Table.nA,{children:slot.samples.map((sample=>sample.section)).join(",")}),(0,jsx_runtime.jsx)(Table.nA,{children:destinationAddress})]},`${slot.address}-${slot.labwareId}-${destinationAddress}`)}))})]})}try{SlotMapperTable.displayName="SlotMapperTable",SlotMapperTable.__docgenInfo={description:"",displayName:"SlotMapperTable",props:{labware:{defaultValue:null,description:"",name:"labware",required:!0,type:{name:"LabwareFlaggedFieldsFragment"}},slots:{defaultValue:null,description:"",name:"slots",required:!0,type:{name:"SlotFieldsFragment[]"}},slotCopyContent:{defaultValue:null,description:"",name:"slotCopyContent",required:!0,type:{name:"SlotCopyContent[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/slotMapper/SlotMapperTable.tsx#SlotMapperTable"]={docgenInfo:SlotMapperTable.__docgenInfo,name:"SlotMapperTable",path:"src/components/slotMapper/SlotMapperTable.tsx#SlotMapperTable"})}catch(__react_docgen_typescript_loader_error){}var classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames);const Heading=_ref=>{let{children,level,className,showBorder=!0}=_ref;const HeadingTag=`h${level}`,headingClasses=classnames_default()({"text-3xl font-bold tracking-tight leading-loose":1===level,"text-2xl font-bold tracking-tight leading-relaxed":2===level,"text-xl font-bold tracking-tight leading-relaxed":3===level,"text-lg font-medium tracking-tight leading-relaxed":4===level,"border-b-2 border-sp":showBorder},className);return(0,jsx_runtime.jsx)(HeadingTag,{"data-testid":"heading",className:headingClasses,children})},components_Heading=Heading;try{Heading.displayName="Heading",Heading.__docgenInfo={description:"",displayName:"Heading",props:{level:{defaultValue:null,description:"",name:"level",required:!0,type:{name:"enum",value:[{value:"1"},{value:"2"},{value:"3"},{value:"4"}]}},showBorder:{defaultValue:{value:"true"},description:"",name:"showBorder",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Heading.tsx#Heading"]={docgenInfo:Heading.__docgenInfo,name:"Heading",path:"src/components/Heading.tsx#Heading"})}catch(__react_docgen_typescript_loader_error){}var MutedText=__webpack_require__("./src/components/MutedText.tsx"),usePager=__webpack_require__("./src/lib/hooks/usePager.ts"),xstate_react_esm=__webpack_require__("./node_modules/@xstate/react/dist/xstate-react.esm.js"),lodash=__webpack_require__("./node_modules/lodash/lodash.js"),ConfirmationModal=__webpack_require__("./src/components/modal/ConfirmationModal.tsx"),Warning=__webpack_require__("./src/components/notifications/Warning.tsx"),sdk=__webpack_require__("./src/types/sdk.ts"),helpers=__webpack_require__("./src/lib/helpers.ts"),labwareHelper=__webpack_require__("./src/lib/helpers/labwareHelper.ts");var lib_sdk=__webpack_require__("./src/lib/sdk.ts"),log_c48e8ab0_esm=__webpack_require__("./node_modules/xstate/dist/log-c48e8ab0.esm.js"),xstate_esm=__webpack_require__("./node_modules/xstate/dist/xstate.esm.js"),xstate_actors_esm=__webpack_require__("./node_modules/xstate/actors/dist/xstate-actors.esm.js"),immer=__webpack_require__("./node_modules/immer/dist/immer.mjs");const colors=(0,helpers.tQ)(),machineImplementations={actions:{assignInputLabware:(0,log_c48e8ab0_esm.a)((_ref=>{let{context,event}=_ref;return"UPDATE_INPUT_LABWARE"===event.type?(0,immer.jM)(context,(draft=>{draft.inputLabware=event.labware,draft.cleanedOutInputAddresses=event.cleanedOutAddresses;let keys=Array.from(draft.failedSlots.keys()).filter((key=>-1===draft.inputLabware.findIndex((labware=>labware.barcode===key))));keys.forEach((key=>draft.failedSlots.delete(key))),keys=Array.from(draft.errors.keys()).filter((key=>-1===draft.inputLabware.findIndex((labware=>labware.barcode===key)))),keys.forEach((key=>draft.errors.delete(key))),draft.outputSlotCopies.forEach((outputScc=>{outputScc.slotCopyContent=outputScc.slotCopyContent.filter((scc=>draft.inputLabware.some((lw=>lw.barcode===scc.sourceBarcode))))}))})):context})),assignOutputLabware:(0,log_c48e8ab0_esm.a)((_ref2=>{let{context,event}=_ref2;return"UPDATE_OUTPUT_LABWARE"===event.type?{...context,outputSlotCopies:event.outputSlotCopyContent}:context})),assignLabwareColors:(0,log_c48e8ab0_esm.a)((_ref3=>{let{context}=_ref3;return(0,immer.jM)(context,(draft=>{draft.inputLabware.forEach((lw=>{draft.colorByBarcode.has(lw.barcode)||draft.colorByBarcode.set(lw.barcode,colors.next().value)}))}))})),checkSlots:(0,log_c48e8ab0_esm.a)((_ref4=>{let{context}=_ref4;const inputLabwareBarcodes=(0,lodash.map)(context.inputLabware,"barcode");return(0,immer.jM)(context,(draft=>{draft.outputSlotCopies.forEach((outputScc=>{outputScc.slotCopyContent=outputScc.slotCopyContent.filter((scc=>inputLabwareBarcodes.includes(scc.sourceBarcode)))}))}))})),clearSlots:(0,log_c48e8ab0_esm.a)((_ref5=>{let{context,event}=_ref5;return"CLEAR_SLOTS"!==event.type?context:(0,immer.jM)(context,(draft=>{const outputScc=draft.outputSlotCopies.find((outputScc=>outputScc.labware.id===event.outputLabwareId));outputScc&&(outputScc.slotCopyContent=outputScc.slotCopyContent.filter((scc=>!event.outputAddresses.includes(scc.destinationAddress))))}))})),clearSlotMappingsBetween:(0,log_c48e8ab0_esm.a)((_ref6=>{let{context,event}=_ref6;return"CLEAR_ALL_SLOT_MAPPINGS_BETWEEN"!==event.type?context:(0,immer.jM)(context,(draft=>{const outputScc=draft.outputSlotCopies.find((outputScc=>outputScc.labware.id===event.outputLabwareId));outputScc&&(outputScc.slotCopyContent=outputScc.slotCopyContent.filter((scc=>scc.sourceBarcode!==event.inputLabwareBarcode)))}))})),copyOneToOneSlots:(0,log_c48e8ab0_esm.a)((_ref7=>{let{context,event}=_ref7;if("COPY_ONE_TO_ONE_SLOTS"!==event.type)return context;const inputLabware=(0,lodash.find)(context.inputLabware,{id:event.inputLabwareId});return(0,immer.jM)(context,(draft=>{const outputScc=draft.outputSlotCopies.find((outputScc=>outputScc.labware.id===event.outputLabwareId));if(!inputLabware||!outputScc)return draft;const outputAddresses=(0,helpers.x)(outputScc.labware.labwareType,sdk._fI.DownRight),destinationAddressIndex=(0,lodash.indexOf)(outputAddresses,event.outputAddress);if(-1===destinationAddressIndex)return draft;const sourceToDestination=function sortWithDirection(addresses,direction){const byColumnIndex=address=>(0,labwareHelper.$Y)(address),byRowIndex=address=>(0,labwareHelper.f6)(address),iteratees=direction===sdk._fI.DownRight?[byColumnIndex,byRowIndex]:[byRowIndex,byColumnIndex];return(0,lodash.orderBy)(addresses,iteratees,["asc","asc"])}(event.inputAddresses,sdk._fI.DownRight).reduce(((memo,sourceAddress,index)=>(memo[sourceAddress]=outputAddresses[destinationAddressIndex+index],memo)),{});if((0,lodash.intersection)((0,lodash.map)(outputScc.slotCopyContent,"destinationAddress"),Object.values(sourceToDestination)).length>0)return draft;if(destinationAddressIndex+event.inputAddresses.length>outputAddresses.length)return draft;const newSlotCopyContent=Object.entries(sourceToDestination).map((_ref8=>{let[sourceAddress,destinationAddress]=_ref8;return{sourceAddress,destinationAddress,sourceBarcode:inputLabware.barcode}}));outputScc.slotCopyContent=outputScc.slotCopyContent.filter((scc=>!(scc.sourceBarcode===inputLabware.barcode&&event.inputAddresses.includes(scc.sourceAddress)))).concat(newSlotCopyContent)}))})),copyManyToOneSlots:(0,log_c48e8ab0_esm.a)((_ref9=>{let{context,event}=_ref9;if("COPY_MANY_TO_ONE_SLOTS"!==event.type)return context;const inputLabware=(0,lodash.find)(context.inputLabware,{id:event.inputLabwareId});return(0,immer.jM)(context,(draft=>{const outputScc=draft.outputSlotCopies.find((outputScc=>outputScc.labware.id===event.outputLabwareId));if(!inputLabware||!outputScc)return draft;const outputAddresses=(0,helpers.x)(outputScc.labware.labwareType,sdk._fI.DownRight);return-1===(0,lodash.indexOf)(outputAddresses,event.outputAddress)||outputScc.slotCopyContent.find((scc=>scc.destinationAddress===event.outputAddress))?draft:void event.inputAddresses.forEach((inputAddress=>outputScc.slotCopyContent.push({destinationAddress:event.outputAddress,sourceBarcode:inputLabware.barcode,sourceAddress:inputAddress})))}))})),copyOneToManySlots:(0,log_c48e8ab0_esm.a)((_ref10=>{let{context,event}=_ref10;if("COPY_ONE_TO_MANY_SLOTS"!==event.type)return context;const inputLabware=(0,lodash.find)(context.inputLabware,{id:event.inputLabwareId});return(0,immer.jM)(context,(draft=>{const outputScc=draft.outputSlotCopies.find((outputScc=>outputScc.labware.id===event.outputLabwareId));if(!inputLabware||!outputScc)return draft;const outputAddresses=(0,helpers.x)(outputScc.labware.labwareType,sdk._fI.DownRight);return-1===(0,lodash.indexOf)(outputAddresses,event.outputAddress)||outputScc.slotCopyContent.find((scc=>scc.destinationAddress===event.outputAddress))?draft:void outputScc.slotCopyContent.push({destinationAddress:event.outputAddress,sourceBarcode:inputLabware.barcode,sourceAddress:event.inputAddress})}))})),assignFailedSlots:(0,log_c48e8ab0_esm.a)((_ref11=>{let{context,event}=_ref11;if("xstate.done.actor.passFailsSlots"!==event.type)return context;const failedSlots=new Map(context.failedSlots);if(event.output.result.passFails&&event.output.result.passFails.length>0){const slotPassFails=event.output.result.passFails[event.output.result.passFails.length-1].slotPassFails;if(slotPassFails){const failedAddresses=slotPassFails.filter((slotPassFail=>slotPassFail.result===sdk.W_V.Fail));failedAddresses.length>0&&failedSlots.set(event.output.barcode,failedAddresses)}}return{...context,failedSlots}})),assignPassFailError:(0,log_c48e8ab0_esm.a)((_ref12=>{let{context,event}=_ref12;return"xstate.error.actor.passFailsSlots"===event.type&&event.barcode?(0,immer.jM)(context,(draft=>{draft.errors.set(event.barcode,event.error)})):context}))}},slotMapper_machine=(0,xstate_esm.Op)({id:"slotMapperMachine",types:{},initial:"ready",context:_ref13=>{let{input}=_ref13;return{...input,failedSlotsCheck:input.failedSlotsCheck||!0,colorByBarcode:new Map,failedSlots:new Map,errors:new Map}},states:{ready:{entry:"assignLabwareColors",on:{COPY_ONE_TO_ONE_SLOTS:{actions:"copyOneToOneSlots"},COPY_ONE_TO_MANY_SLOTS:{actions:"copyOneToManySlots"},COPY_MANY_TO_ONE_SLOTS:{actions:"copyManyToOneSlots"},CLEAR_SLOTS:{actions:"clearSlots"},CLEAR_ALL_SLOT_MAPPINGS_BETWEEN:{actions:"clearSlotMappingsBetween"},UPDATE_INPUT_LABWARE:[{target:"updatingLabware",guard:_ref14=>{let{context}=_ref14;return context.failedSlotsCheck},actions:["assignInputLabware","assignLabwareColors","checkSlots"]},{actions:["assignInputLabware","assignLabwareColors","checkSlots"]}],UPDATE_OUTPUT_LABWARE:{actions:"assignOutputLabware"},LOCK:"locked"}},updatingLabware:{invoke:{id:"passFailsSlots",src:(0,xstate_actors_esm.Sx)((async _ref15=>{let{input}=_ref15;if(!input)return Promise.reject("No labwares scanned");const response=await lib_sdk.Uc.FindPassFails({barcode:input.labware[input.labware.length-1].barcode,operationType:"Slide processing"});return{barcode:input.labware[input.labware.length-1].barcode,result:response}})),input:_ref16=>{let{event}=_ref16;if("UPDATE_INPUT_LABWARE"===event.type)return{labware:event.labware}},onDone:{target:"ready",actions:"assignFailedSlots"},onError:{target:"ready",actions:"assignPassFailError"}}},locked:{on:{UNLOCK:"ready"}}}},{...machineImplementations});var PinkButton=__webpack_require__("./src/components/buttons/PinkButton.tsx"),RadioGroup=__webpack_require__("./src/components/forms/RadioGroup.tsx"),slotHelper=__webpack_require__("./src/lib/helpers/slotHelper.ts");const SlotMapper=_ref=>{var _currentOutput$slotCo;let{onChange,onInputLabwareChange,onOutputLabwareChange,initialInputLabware=[],initialOutputLabware=[],locked=!1,inputLabwareLimit,failedSlotsCheck=!0,disabledOutputSlotAddresses=[],slotCopyModes,inputLabwareConfigPanel,outputLabwareConfigPanel,onSelectInputLabware,onSelectOutputLabware,displayMappedTable=!0,labwareType,cleanedOutInputAddresses}=_ref;const memoSlotMapperMachine=react.useMemo((()=>slotMapper_machine),[]),[current,send]=(0,xstate_react_esm.zl)(memoSlotMapperMachine,{input:{inputLabware:initialInputLabware,outputSlotCopies:initialOutputLabware,failedSlotsCheck,cleanedOutInputAddresses}}),{inputLabware,outputSlotCopies,colorByBarcode,failedSlots,errors}=current.context;(0,react.useEffect)((()=>{initialOutputLabware.length!==outputSlotCopies.length&&send({type:"UPDATE_OUTPUT_LABWARE",outputSlotCopyContent:initialOutputLabware})}));const[currentInputLabware,setCurrentInputLabware]=(0,react.useState)((()=>0===(null==initialInputLabware?void 0:initialInputLabware.length)?null:initialInputLabware[0])),[currentOutput,setCurrentOutput]=(0,react.useState)((()=>0===(null==initialOutputLabware?void 0:initialOutputLabware.length)?null:initialOutputLabware[0])),[selectedInputAddresses,setSelectedInputAddresses]=(0,react.useState)([]),[selectedOutputAddresses,setSelectedOutputAddresses]=(0,react.useState)([]),[failedSelectSlots,setFailedSelectSlots]=(0,react.useState)([]),[destinationAddress,setDestinationAddress]=(0,react.useState)(),[selectedCopyMode,setSelectedCopyMode]=(0,react.useState)(SlotCopyMode.ONE_TO_ONE),[oneToManyCopyInProgress,setOneToManyCopyInProgress]=(0,react.useState)(!1),{currentPage:currentInputPage,numberOfPages:numberOfInputPages,setNumberOfPages:setNumberOfInputPages,setCurrentPage:setCurrentInputPage,goToLastPage:goToLastInputPage,...pagerRestInput}=(0,usePager.X)({initialCurrentPage:1,initialNumberOfPages:inputLabware.length}),{currentPage:currentOutputPage,numberOfPages:numberOfOutputPages,setNumberOfPages:setNumberOfOutputPages,setCurrentPage:setCurrentOutputPage,goToLastPage:goToLastOutputPage,...pageRestOutput}=(0,usePager.X)({initialCurrentPage:1,initialNumberOfPages:outputSlotCopies.length}),anySourceMapped=(0,react.useMemo)((()=>0!==inputLabware.length&&(!!currentOutput&&currentOutput.slotCopyContent.length>0)),[currentOutput,inputLabware]),memoInputAddressesDisabled=react.useMemo((()=>{if(!currentOutput||!currentInputLabware)return[];return outputSlotCopies.filter((osc=>osc.labware.id!==currentOutput.labware.id)).flatMap((item=>item.slotCopyContent)).filter((scc=>scc.sourceBarcode===currentInputLabware.barcode)).map((slot=>slot.sourceAddress))}),[currentOutput,currentInputLabware,outputSlotCopies]);(0,react.useEffect)((()=>{if(!currentOutput&&0===(null==initialOutputLabware?void 0:initialOutputLabware.length))return;const matchingLabware=null==initialOutputLabware?void 0:initialOutputLabware.find((outputLw=>outputLw.labware.id===(null==currentOutput?void 0:currentOutput.labware.id)));matchingLabware&&matchingLabware.labware.barcode!==(null==currentOutput?void 0:currentOutput.labware.barcode)&&setCurrentOutput((prev=>prev&&prev.labware.barcode!==matchingLabware.labware.barcode?{...prev,labware:{...prev.labware,barcode:matchingLabware.labware.barcode,cleanedOutAddresses:matchingLabware.cleanedOutAddresses}}:prev)),initialOutputLabware.some((lw=>!outputSlotCopies.map((osc=>osc.labware.id)).includes(lw.labware.id)))&&send({type:"UPDATE_OUTPUT_LABWARE",outputSlotCopyContent:initialOutputLabware})}),[initialOutputLabware,outputSlotCopies,send,currentOutput]);const getSourceSlotColor=(0,react.useCallback)(((labware,address,slot)=>{var _slot$samples;return selectedCopyMode===SlotCopyMode.ONE_TO_MANY&&oneToManyCopyInProgress&&selectedInputAddresses[0]===address?`bg-${colorByBarcode.get(labware.barcode)}-500 ring ring-pink-600 ring-offset-2`:(0,lodash.find)(currentOutput&&currentOutput.slotCopyContent,{sourceBarcode:labware.barcode,sourceAddress:address})?`bg-${colorByBarcode.get(labware.barcode)}-200 ${selectedInputAddresses.includes(address)?"ring ring-blue-600 ring-offset-2":""}`:memoInputAddressesDisabled.includes(address)?"bg-gray-300 ring-0 ring-offset-0 text-white border-0 border-gray-300":null!=slot&&null!==(_slot$samples=slot.samples)&&void 0!==_slot$samples&&_slot$samples.length?`bg-${colorByBarcode.get(labware.barcode)}-500`:void 0}),[currentOutput,colorByBarcode,memoInputAddressesDisabled,selectedCopyMode,selectedInputAddresses,oneToManyCopyInProgress]),getDestinationSlotColor=(0,react.useCallback)(((outputSlotCopyData,address)=>{if(null!=currentOutput&&currentOutput.labware.barcode){const slot=currentOutput.labware.slots.find((s=>s.address===address));if(slot&&(0,slotHelper.lA)(slot))return"bg-gray-300 ring-0 ring-offset-0 text-gray-300 border-0 border-gray-300"}if(null!=disabledOutputSlotAddresses&&disabledOutputSlotAddresses.includes(address))return"bg-gray-300 ring-0 ring-offset-0 text-gray-300 border-0 border-gray-300";const scc=(0,lodash.find)(outputSlotCopyData.slotCopyContent,{destinationAddress:address});return scc?currentInputLabware&&currentInputLabware.barcode===scc.sourceBarcode&&selectedInputAddresses.includes(scc.sourceAddress)&&!oneToManyCopyInProgress?`bg-${colorByBarcode.get(scc.sourceBarcode)}-500 ring ring-blue-600 ring-offset-2`:`bg-${colorByBarcode.get(scc.sourceBarcode)}-500`:void 0}),[colorByBarcode,disabledOutputSlotAddresses,oneToManyCopyInProgress,selectedInputAddresses,currentInputLabware,null==currentOutput?void 0:currentOutput.labware]);(0,react.useEffect)((()=>{setNumberOfInputPages(inputLabware.length)}),[inputLabware,setNumberOfInputPages]);const previousInputLength=usePrevious(inputLabware.length);(0,react.useEffect)((()=>{previousInputLength&&inputLabware.length>previousInputLength&&goToLastInputPage()}),[inputLabware.length,goToLastInputPage,previousInputLength]),(0,react.useEffect)((()=>{0===inputLabware.length||currentInputPage<=0||inputLabware.length<=currentInputPage-1||(setCurrentInputLabware(inputLabware[currentInputPage-1]),null==onSelectInputLabware||onSelectInputLabware(inputLabware[currentInputPage-1]))}),[currentInputPage,inputLabware,onSelectInputLabware,setCurrentInputLabware]);const numberOfOutputLabware=outputSlotCopies.length;(0,react.useEffect)((()=>{setNumberOfOutputPages(numberOfOutputLabware)}),[numberOfOutputLabware,setNumberOfOutputPages]);const previousOutputLength=usePrevious(outputSlotCopies.length);(0,react.useEffect)((()=>{previousOutputLength&&outputSlotCopies.length>previousOutputLength&&goToLastOutputPage()}),[outputSlotCopies.length,goToLastOutputPage,previousOutputLength]),(0,react.useEffect)((()=>{0===outputSlotCopies.length||currentOutputPage<=0||outputSlotCopies.length<=currentOutputPage-1?setCurrentOutput(null):(setCurrentOutput(outputSlotCopies[currentOutputPage-1]),null==onSelectOutputLabware||onSelectOutputLabware(outputSlotCopies[currentOutputPage-1].labware))}),[currentOutputPage,outputSlotCopies,onSelectOutputLabware,setCurrentOutput]),(0,react.useEffect)((()=>{setSelectedInputAddresses([])}),[currentInputLabware]),(0,react.useEffect)((()=>{send(locked?{type:"LOCK"}:{type:"UNLOCK"})}),[locked,send]);const inputLabwareRef=(0,react.useRef)(null),outputLabwareRef=(0,react.useRef)(null),handleCopySlots=react.useCallback((givenDestinationAddress=>{var _currentOutput$labwar;setFailedSelectSlots([]);const address=destinationAddress||givenDestinationAddress;var _currentOutput$labwar2;null!=currentInputLabware&&currentInputLabware.id&&null!=currentOutput&&null!==(_currentOutput$labwar=currentOutput.labware)&&void 0!==_currentOutput$labwar&&_currentOutput$labwar.id&&address&&send({type:"COPY_ONE_TO_ONE_SLOTS",inputLabwareId:null==currentInputLabware?void 0:currentInputLabware.id,inputAddresses:selectedInputAddresses,outputLabwareId:null==currentOutput||null===(_currentOutput$labwar2=currentOutput.labware)||void 0===_currentOutput$labwar2?void 0:_currentOutput$labwar2.id,outputAddress:address});setDestinationAddress(void 0)}),[currentInputLabware,currentOutput,destinationAddress,selectedInputAddresses,send]),handleOneToOneCopy=react.useCallback((outputAddress=>{var _currentOutput$labwar3;if(null==disabledOutputSlotAddresses||!disabledOutputSlotAddresses.includes(outputAddress)){if(setDestinationAddress(outputAddress),null!=currentOutput&&null!==(_currentOutput$labwar3=currentOutput.labware)&&void 0!==_currentOutput$labwar3&&_currentOutput$labwar3.barcode){var _currentOutput$labwar4;const slot=null==currentOutput||null===(_currentOutput$labwar4=currentOutput.labware)||void 0===_currentOutput$labwar4?void 0:_currentOutput$labwar4.slots.find((slot=>slot.address===outputAddress));if(slot&&(0,slotHelper.lA)(slot))return}if(currentInputLabware){const slotFails=failedSlots.get(currentInputLabware.barcode);if(!slotFails)return void handleCopySlots(outputAddress);{const failedSelectSlots=slotFails.filter((slot=>-1!==selectedInputAddresses.findIndex((address=>address===slot.address))));if(setFailedSelectSlots(failedSelectSlots),0===failedSelectSlots.length)return void handleCopySlots(outputAddress)}}}}),[currentInputLabware,handleCopySlots,failedSlots,selectedInputAddresses,disabledOutputSlotAddresses,null==currentOutput?void 0:currentOutput.labware]),handleOneToManyCopy=react.useCallback((outputAddress=>{var _currentOutput$labwar5;if(null!=disabledOutputSlotAddresses&&disabledOutputSlotAddresses.includes(outputAddress))return;if(!oneToManyCopyInProgress)return;setDestinationAddress(outputAddress),setFailedSelectSlots([]);const address=destinationAddress||outputAddress;var _currentOutput$labwar6;null!=currentInputLabware&&currentInputLabware.id&&null!=currentOutput&&null!==(_currentOutput$labwar5=currentOutput.labware)&&void 0!==_currentOutput$labwar5&&_currentOutput$labwar5.id&&address&&send({type:"COPY_ONE_TO_MANY_SLOTS",inputLabwareId:null==currentInputLabware?void 0:currentInputLabware.id,inputAddress:selectedInputAddresses[0],outputLabwareId:null==currentOutput||null===(_currentOutput$labwar6=currentOutput.labware)||void 0===_currentOutput$labwar6?void 0:_currentOutput$labwar6.id,outputAddress:address});setDestinationAddress(void 0)}),[setDestinationAddress,destinationAddress,oneToManyCopyInProgress,send,currentInputLabware,currentOutput,disabledOutputSlotAddresses,selectedInputAddresses]),handleManyToOneCopy=react.useCallback((outputAddress=>{var _currentOutput$labwar7;if(null!=disabledOutputSlotAddresses&&disabledOutputSlotAddresses.includes(outputAddress))return;setDestinationAddress(outputAddress),setFailedSelectSlots([]);const address=destinationAddress||outputAddress;var _currentOutput$labwar8;null!=currentInputLabware&&currentInputLabware.id&&null!=currentOutput&&null!==(_currentOutput$labwar7=currentOutput.labware)&&void 0!==_currentOutput$labwar7&&_currentOutput$labwar7.id&&address&&send({type:"COPY_MANY_TO_ONE_SLOTS",inputLabwareId:null==currentInputLabware?void 0:currentInputLabware.id,inputAddresses:selectedInputAddresses,outputLabwareId:null==currentOutput||null===(_currentOutput$labwar8=currentOutput.labware)||void 0===_currentOutput$labwar8?void 0:_currentOutput$labwar8.id,outputAddress:address});setDestinationAddress(void 0)}),[setDestinationAddress,destinationAddress,send,currentInputLabware,currentOutput,disabledOutputSlotAddresses,selectedInputAddresses]),handleOnOutputLabwareSlotClick=react.useCallback((outputAddress=>{switch(selectedCopyMode){case SlotCopyMode.ONE_TO_ONE:handleOneToOneCopy(outputAddress);break;case SlotCopyMode.ONE_TO_MANY:handleOneToManyCopy(outputAddress);break;case SlotCopyMode.MANY_TO_ONE:handleManyToOneCopy(outputAddress)}}),[handleOneToOneCopy,handleManyToOneCopy,handleOneToManyCopy,selectedCopyMode]),handleOnInputLabwareSlotClick=react.useCallback((inputAddress=>{if(selectedCopyMode===SlotCopyMode.ONE_TO_MANY){if(oneToManyCopyInProgress)return;if(0===inputAddress.length)return void setSelectedInputAddresses([]);(0,lodash.find)(null==currentOutput?void 0:currentOutput.slotCopyContent,{sourceBarcode:null==currentInputLabware?void 0:currentInputLabware.barcode,sourceAddress:inputAddress[0]})||setOneToManyCopyInProgress(!0)}setSelectedInputAddresses(inputAddress.filter((address=>!memoInputAddressesDisabled.includes(address))))}),[setSelectedInputAddresses,memoInputAddressesDisabled,setOneToManyCopyInProgress,selectedCopyMode,null==currentInputLabware?void 0:currentInputLabware.barcode,null==currentOutput?void 0:currentOutput.slotCopyContent,oneToManyCopyInProgress]),handleOnClickClear=react.useCallback((()=>{var _currentOutput$labwar9,_currentOutput$labwar10,_outputLabwareRef$cur;null!=currentOutput&&null!==(_currentOutput$labwar9=currentOutput.labware)&&void 0!==_currentOutput$labwar9&&_currentOutput$labwar9.id&&(send({type:"CLEAR_SLOTS",outputLabwareId:null==currentOutput||null===(_currentOutput$labwar10=currentOutput.labware)||void 0===_currentOutput$labwar10?void 0:_currentOutput$labwar10.id,outputAddresses:selectedOutputAddresses}),null===(_outputLabwareRef$cur=outputLabwareRef.current)||void 0===_outputLabwareRef$cur||_outputLabwareRef$cur.deselectAll())}),[send,currentOutput,selectedOutputAddresses,outputLabwareRef]),handleOnClickClearAll=react.useCallback((()=>{var _currentOutput$labwar11,_currentOutput$labwar12,_outputLabwareRef$cur2;null!=currentOutput&&null!==(_currentOutput$labwar11=currentOutput.labware)&&void 0!==_currentOutput$labwar11&&_currentOutput$labwar11.id&&null!=currentInputLabware&&currentInputLabware.barcode&&(send({type:"CLEAR_ALL_SLOT_MAPPINGS_BETWEEN",outputLabwareId:null==currentOutput||null===(_currentOutput$labwar12=currentOutput.labware)||void 0===_currentOutput$labwar12?void 0:_currentOutput$labwar12.id,inputLabwareBarcode:null==currentInputLabware?void 0:currentInputLabware.barcode}),null===(_outputLabwareRef$cur2=outputLabwareRef.current)||void 0===_outputLabwareRef$cur2||_outputLabwareRef$cur2.deselectAll())}),[send,currentOutput,currentInputLabware,outputLabwareRef]);(0,react.useEffect)((()=>{var _inputLabwareRef$curr;null===(_inputLabwareRef$curr=inputLabwareRef.current)||void 0===_inputLabwareRef$curr||_inputLabwareRef$curr.deselectAll()}),[null==currentOutput?void 0:currentOutput.slotCopyContent,currentInputLabware]),(0,react.useEffect)((()=>{var _outputLabwareRef$cur3;null===(_outputLabwareRef$cur3=outputLabwareRef.current)||void 0===_outputLabwareRef$cur3||_outputLabwareRef$cur3.deselectAll()}),[null==currentOutput?void 0:currentOutput.slotCopyContent,currentInputLabware]),(0,react.useEffect)((()=>{null!=currentOutput&&currentOutput.slotCopyContent&&(null==onChange||onChange(currentOutput.labware,null==currentOutput?void 0:currentOutput.slotCopyContent,anySourceMapped))}),[onChange,currentOutput,anySourceMapped]);const onLabwareScannerChange=react.useCallback(((labware,cleanedOutAddresses)=>{send({type:"UPDATE_INPUT_LABWARE",labware,cleanedOutAddresses}),null==onInputLabwareChange||onInputLabwareChange(labware,cleanedOutAddresses)}),[send,onInputLabwareChange]),onRemoveOutputLabware=react.useCallback((()=>{const outputs=outputSlotCopies.filter((osc=>osc.labware.id!==(null==currentOutput?void 0:currentOutput.labware.id)));send({type:"UPDATE_OUTPUT_LABWARE",outputSlotCopyContent:outputs}),null==onOutputLabwareChange||onOutputLabwareChange(outputs.map((o=>o.labware)))}),[send,onOutputLabwareChange,currentOutput,outputSlotCopies]),selectedInputSlots=currentInputLabware?currentInputLabware.slots.filter((slot=>-1!==selectedInputAddresses.findIndex((selectedAddress=>selectedAddress===slot.address)))):[],slotsMappedForCurrentInput=null==currentOutput?void 0:currentOutput.slotCopyContent.some((slotCopy=>slotCopy.sourceBarcode===(null==currentInputLabware?void 0:currentInputLabware.barcode))),handleCopyModeChange=react.useCallback((mode=>{setSelectedCopyMode(mode),setOneToManyCopyInProgress(!1)}),[setSelectedCopyMode,setOneToManyCopyInProgress]),onFinishTransferButtonClick=react.useCallback((()=>{setOneToManyCopyInProgress(!1),setSelectedInputAddresses([]),setSelectedOutputAddresses([])}),[setOneToManyCopyInProgress,setSelectedOutputAddresses,setSelectedInputAddresses]);return(0,jsx_runtime.jsxs)("div",{className:"space-y-8",children:[(0,jsx_runtime.jsxs)("div",{className:"grid grid-cols-2 auto-rows-auto",children:[(0,jsx_runtime.jsx)(components_Heading,{level:4,children:"Input Labware"}),(0,jsx_runtime.jsx)(components_Heading,{level:4,children:"Output Labware"}),slotCopyModes&&slotCopyModes.length>1&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(RadioGroup.Ay,{label:"Select transfer mode",name:"sectionNumber",withFormik:!1,children:slotCopyModes.map((mode=>(0,jsx_runtime.jsx)(RadioGroup.Sq,{"data-testid":`copyMode-${mode}`,name:"copyMode",value:mode,checked:selectedCopyMode===mode,onChange:()=>handleCopyModeChange(mode),label:mode},mode)))})}),(0,jsx_runtime.jsx)("div",{className:"flex flex-row w-full my-2 ",children:(0,jsx_runtime.jsxs)("div",{className:"flex flex-col my-2 text-gray-700 lg:text-xs italic",children:[(0,jsx_runtime.jsx)("p",{children:"For selection of multiple slots :"}),(0,jsx_runtime.jsx)("p",{children:"Hold 'Shift' key to select consecutive items"}),(0,jsx_runtime.jsx)("p",{children:"Hold 'Ctrl' (Cmd for Mac) key to select non-consecutive items"})]})})]}),(0,jsx_runtime.jsx)("div",{id:"inputLabwares",className:"bg-gray-100 p-4",children:(0,jsx_runtime.jsx)(LabwareScanner.A,{initialLabwares:inputLabware.filter((labware=>labware.barcode.length>0)),onChange:onLabwareScannerChange,limit:inputLabwareLimit,enableFlaggedLabwareCheck:!0,checkForCleanedOutAddresses:!0,initCleanedOutAddresses:current.context.cleanedOutInputAddresses,children:_ref2=>{var _current$context$clea,_current$context$clea2;let{removeLabware,cleanedOutAddresses}=_ref2;return currentInputLabware?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{className:"flex mb-8",children:inputLabwareConfigPanel}),!locked&&inputLabware.length>0&&(0,jsx_runtime.jsx)("div",{className:"flex flex-row justify-end",children:(0,jsx_runtime.jsx)(RemoveButton.A,{onClick:()=>{removeLabware(currentInputLabware.barcode),null==onInputLabwareChange||onInputLabwareChange(inputLabware)}})}),inputLabware.length>0&&(0,jsx_runtime.jsx)("div",{className:"flex flex-col items-center justify-center","data-testid":"input-labware-div",children:(0,jsx_runtime.jsx)(Labware.A,{labware:currentInputLabware,selectable:oneToManyCopyInProgress?"none":"non_empty",selectionMode:selectedCopyMode!==SlotCopyMode.ONE_TO_MANY?"multi":"single",labwareRef:inputLabwareRef,slotColor:(address,slot)=>getSourceSlotColor(currentInputLabware,address,slot),name:currentInputLabware.labwareType.name,onSelect:handleOnInputLabwareSlotClick,cleanedOutAddresses:null!==(_current$context$clea=null===(_current$context$clea2=current.context.cleanedOutInputAddresses)||void 0===_current$context$clea2?void 0:_current$context$clea2.get(currentInputLabware.id))&&void 0!==_current$context$clea?_current$context$clea:null==cleanedOutAddresses?void 0:cleanedOutAddresses.get(currentInputLabware.id)})})]}):(0,jsx_runtime.jsx)(MutedText.A,{children:"Add labware using the scan input above"})}})}),(0,jsx_runtime.jsxs)("div",{id:"outputLabwares","data-testid":"outputLabwares",className:"p-4 flex flex-col  bg-gray-100 border-l-2",children:[(0,jsx_runtime.jsx)("div",{children:outputLabwareConfigPanel}),(null==initialOutputLabware?void 0:initialOutputLabware.length)>1&&(0,jsx_runtime.jsx)("div",{className:"flex flex-row justify-end",children:(0,jsx_runtime.jsx)(RemoveButton.A,{onClick:()=>{onRemoveOutputLabware()}})}),(0,jsx_runtime.jsx)("div",{className:"flex items-center justify-center",children:(null==initialOutputLabware?void 0:initialOutputLabware.length)>0&&(null==currentOutput?void 0:currentOutput.labware)&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,jsx_runtime.jsx)("div",{className:"flex justify-end",children:oneToManyCopyInProgress&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-col items-end",children:[(0,jsx_runtime.jsx)(PinkButton.A,{onClick:onFinishTransferButtonClick,children:`Finish mapping for ${selectedInputAddresses[0]}`}),(0,jsx_runtime.jsx)(MutedText.A,{children:"Press when you finish"})]})}),(void 0===labwareType||labwareType.length>0)&&(0,jsx_runtime.jsx)(Labware.A,{labware:currentOutput.labware,selectable:"any",selectionMode:"multi",labwareRef:outputLabwareRef,name:null==currentOutput?void 0:currentOutput.labware.labwareType.name,onSlotClick:handleOnOutputLabwareSlotClick,onSelect:setSelectedOutputAddresses,slotColor:address=>getDestinationSlotColor(currentOutput,address),cleanedOutAddresses:currentOutput.cleanedOutAddresses})]})})]}),(0,jsx_runtime.jsx)("div",{className:"border-gray-300 border-t-2 p-4 flex flex-row items-center justify-between bg-gray-200",children:inputLabware.length>0&&(0,jsx_runtime.jsx)(Pager.A,{currentPage:currentInputPage,numberOfPages:numberOfInputPages,...pagerRestInput})}),(0,jsx_runtime.jsxs)("div",{className:"border-gray-300 border-t-2 p-4 flex flex-row items-center justify-between bg-gray-200",children:[(0,jsx_runtime.jsx)("div",{children:outputSlotCopies.length>0&&(0,jsx_runtime.jsx)(Pager.A,{currentPage:currentOutputPage,numberOfPages:numberOfOutputPages,...pageRestOutput})}),(0,jsx_runtime.jsx)("div",{className:"border-gray-300 flex-row items-center justify-end bg-gray-200",children:!locked&&(0,jsx_runtime.jsxs)("div",{className:"flex flex-row space-x-4 justify-end",children:[(0,jsx_runtime.jsx)(WhiteButton.A,{onClick:handleOnClickClear,children:"Clear"}),(0,jsx_runtime.jsx)(WhiteButton.A,{"data-testid":"clearAll",onClick:handleOnClickClearAll,children:"Clear all"})]})})]})]}),currentInputLabware&&(selectedInputSlots.length>0||currentOutput&&slotsMappedForCurrentInput&&displayMappedTable)&&(0,jsx_runtime.jsxs)("div",{className:"space-y-4","data-testid":"mapping-div",children:[(0,jsx_runtime.jsx)(components_Heading,{level:4,children:selectedInputSlots.length>0?`Slot mapping for slot(s) ${selectedInputAddresses.join(",")}`:`Slot mapping for ${currentInputLabware.barcode}`}),(0,jsx_runtime.jsx)(SlotMapperTable,{labware:currentInputLabware,slots:selectedInputSlots,slotCopyContent:null!==(_currentOutput$slotCo=null==currentOutput?void 0:currentOutput.slotCopyContent)&&void 0!==_currentOutput$slotCo?_currentOutput$slotCo:[]})]}),(0,jsx_runtime.jsxs)(ConfirmationModal.R,{show:failedSelectSlots.length>0,header:"Slot transfer",message:{type:"Warning",text:"Failed slot(s)"},confirmOptions:[{label:"Cancel",action:()=>{setFailedSelectSlots([])}},{label:"Continue",action:handleCopySlots}],children:[(0,jsx_runtime.jsx)("p",{className:"font-bold mt-8",children:"Following slot(s) failed in slide processing : "}),(0,jsx_runtime.jsxs)(Table.Ay,{className:"mt-4 w-full",children:[(0,jsx_runtime.jsx)(Table.nd,{children:(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)(Table.A0,{children:"Address"}),(0,jsx_runtime.jsx)(Table.A0,{children:"Comment"})]})}),(0,jsx_runtime.jsx)(Table.BF,{children:failedSelectSlots.map((slot=>(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)(Table.nA,{children:slot.address}),(0,jsx_runtime.jsx)(Table.nA,{children:slot.comment})]},slot.address)))})]}),(0,jsx_runtime.jsx)("p",{className:"mt-6 font-bold",children:"Do you wish to continue or cancel?"})]}),(0,jsx_runtime.jsx)("div",{className:"flex flex-col w-full",children:errors.size>0&&(0,jsx_runtime.jsx)(Warning.A,{message:`There is an error while fetching pass/fail status for the slots in ${null==currentInputLabware?void 0:currentInputLabware.barcode}.`})})]})},slotMapper_SlotMapper=SlotMapper;try{SlotMapper.displayName="SlotMapper",SlotMapper.__docgenInfo={description:"",displayName:"SlotMapper",props:{onChange:{defaultValue:null,description:"Callback that's called whenever a slot is mapped or unmapped\n@param slotCopyContent the current mapping of source to destination slots\n@param allSourcesMapped true if input labware exists and their non-empty slots have been mapped, false otherwise",name:"onChange",required:!1,type:{name:"((labware: NewFlaggedLabwareLayout, slotCopyContent: SlotCopyContent[], allSourcesMapped: boolean) => void)"}},onInputLabwareChange:{defaultValue:null,description:"Callback to notify whenever an input labware is scanned/removed",name:"onInputLabwareChange",required:!1,type:{name:"((labwaresWithoutPerm: LabwareFlaggedFieldsFragment[], cleanedOutAddresses?: Map<number, string[]>) => void)"}},onOutputLabwareChange:{defaultValue:null,description:"Callback to notify whenever an output labware is removed",name:"onOutputLabwareChange",required:!1,type:{name:"((labwaresWithoutPerm: NewFlaggedLabwareLayout[]) => void)"}},locked:{defaultValue:{value:"false"},description:"Lock the SlotMapper.",name:"locked",required:!1,type:{name:"boolean"}},initialInputLabware:{defaultValue:{value:"[]"},description:"Input labware",name:"initialInputLabware",required:!1,type:{name:"LabwareFlaggedFieldsFragment[]"}},initialOutputLabware:{defaultValue:{value:"[]"},description:"Output labware",name:"initialOutputLabware",required:!1,type:{name:"OutputSlotCopyData[]"}},failedSlotsCheck:{defaultValue:{value:"true"},description:"Is it required to check failed slots in slide processing",name:"failedSlotsCheck",required:!1,type:{name:"boolean"}},inputLabwareLimit:{defaultValue:null,description:"Maximum number of input labware allowed to scan, if required",name:"inputLabwareLimit",required:!1,type:{name:"number"}},disabledOutputSlotAddresses:{defaultValue:{value:"[]"},description:"Disabled slots in output labware , if any",name:"disabledOutputSlotAddresses",required:!1,type:{name:"string[]"}},inputLabwareConfigPanel:{defaultValue:null,description:"Panel to display on top of input labware, if any*",name:"inputLabwareConfigPanel",required:!1,type:{name:"ReactNode"}},outputLabwareConfigPanel:{defaultValue:null,description:"Panel to display on top of output labware, if any*",name:"outputLabwareConfigPanel",required:!1,type:{name:"ReactNode"}},slotCopyModes:{defaultValue:null,description:"Slot copy modes*",name:"slotCopyModes",required:!1,type:{name:"SlotCopyMode[]"}},displayMappedTable:{defaultValue:{value:"true"},description:"Display mapping table*",name:"displayMappedTable",required:!1,type:{name:"boolean"}},onSelectOutputLabware:{defaultValue:null,description:"Callback to notify when an output labware is selected (through pagination)*",name:"onSelectOutputLabware",required:!1,type:{name:"((labware: NewFlaggedLabwareLayout) => void)"}},onSelectInputLabware:{defaultValue:null,description:"Callback to notify when an input labware is selected (through pagination)*",name:"onSelectInputLabware",required:!1,type:{name:"((labware: LabwareFlaggedFieldsFragment) => void)"}},onOutputLabwareSelectionModeChange:{defaultValue:null,description:"Callback to notify when an output labware selection type changes",name:"onOutputLabwareSelectionModeChange",required:!1,type:{name:"((mode: DestinationSelectionMode) => void)"}},selectedDestinationMode:{defaultValue:null,description:"",name:"selectedDestinationMode",required:!1,type:{name:"enum",value:[{value:'"96 Well Plate"'},{value:'"8 Strip Tube"'},{value:'"Scan Labware"'}]}},cleanedOutInputAddresses:{defaultValue:null,description:"",name:"cleanedOutInputAddresses",required:!1,type:{name:"Map<number, string[]>"}},labwareType:{defaultValue:{value:"undefined"},description:"",name:"labwareType",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/slotMapper/SlotMapper.tsx#SlotMapper"]={docgenInfo:SlotMapper.__docgenInfo,name:"SlotMapper",path:"src/components/slotMapper/SlotMapper.tsx#SlotMapper"})}catch(__react_docgen_typescript_loader_error){}var labwareFactory=__webpack_require__("./src/lib/factories/labwareFactory.ts"),labwareTypeFactory=__webpack_require__("./src/lib/factories/labwareTypeFactory.ts"),stan=__webpack_require__("./src/types/stan.ts");const SlotMapper_stories={title:"Slot Mapper",component:slotMapper_SlotMapper},Default=(args=>(0,jsx_runtime.jsx)(slotMapper_SlotMapper,{...args})).bind({});Default.args={initialInputLabware:labwareFactory.Ay.buildList(3,void 0,{associations:{labwareType:labwareTypeFactory.q[stan.y1.VISIUM_LP].build()}}),initialOutputLabware:[{labware:labwareFactory.Z3.build(),slotCopyContent:[]}]},Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"args => <SlotMapper {...args} />",...Default.parameters?.docs?.source}}};const __namedExportsOrder=["Default"]},"./src/components/buttons/PinkButton.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/react/index.js");var _Button__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/components/buttons/Button.tsx"),classnames__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_2__),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react/jsx-runtime.js");const PinkButton=_ref=>{let{children,className,action="primary",...rest}=_ref;const buttonClasses=classnames__WEBPACK_IMPORTED_MODULE_2___default()({"text-white bg-sp hover:bg-sp-600 shadow-sm focus:border-sp-700 focus:shadow-outline-sp active:bg-sp-700":"primary"===action,"text-sp bg-transparent border border-sp shadow-sm hover:bg-sp-100 focus:border-sp-400 focus:shadow-outline-sp active:bg-sp-200":"secondary"===action,"text-sp bg-transparent hover:text-sp-700 active:text-sp-800":"tertiary"===action},className);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_Button__WEBPACK_IMPORTED_MODULE_1__.A,{...rest,className:buttonClasses,children})},__WEBPACK_DEFAULT_EXPORT__=PinkButton;try{PinkButton.displayName="PinkButton",PinkButton.__docgenInfo={description:"",displayName:"PinkButton",props:{loading:{defaultValue:null,description:"",name:"loading",required:!1,type:{name:"boolean"}},action:{defaultValue:{value:"primary"},description:"",name:"action",required:!1,type:{name:"enum",value:[{value:'"primary"'},{value:'"secondary"'},{value:'"tertiary"'}]}},miniButton:{defaultValue:null,description:"",name:"miniButton",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/buttons/PinkButton.tsx#PinkButton"]={docgenInfo:PinkButton.__docgenInfo,name:"PinkButton",path:"src/components/buttons/PinkButton.tsx#PinkButton"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/forms/RadioGroup.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Ay:()=>__WEBPACK_DEFAULT_EXPORT__,Sq:()=>RadioButtonInput,a:()=>RadioButton});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),formik__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/formik/dist/formik.esm.js"),_index__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/components/forms/index.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js");const RadioGroupContext=react__WEBPACK_IMPORTED_MODULE_0__.createContext({name:""}),RadioGroup=_ref=>{let{label,name,children,withFormik=!0}=_ref;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)("div",{className:"mt-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("span",{className:"text-gray-800",children:label}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("div",{className:"lg:space-x-6",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(RadioGroupContext.Provider,{value:{name},children})})]}),withFormik&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_index__WEBPACK_IMPORTED_MODULE_1__.sM,{name})]})},__WEBPACK_DEFAULT_EXPORT__=RadioGroup,RadioButton=_ref2=>{let{name,value}=_ref2;const ctx=(0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(RadioGroupContext);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)("label",{className:"inline-flex items-center",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(formik__WEBPACK_IMPORTED_MODULE_3__.D0,{type:"radio",className:"form-radio text-sp",name:ctx.name,value,"data-testid":value}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("span",{className:"ml-2",children:name})]})},RadioButtonInput=react__WEBPACK_IMPORTED_MODULE_0__.forwardRef(((props,ref)=>{var _props$name;const ctx=(0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(RadioGroupContext);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)("label",{className:"inline-flex items-center",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("input",{ref,...props,type:"radio",name:null!==(_props$name=props.name)&&void 0!==_props$name?_props$name:ctx.name}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("span",{className:`ml-2 ${props.disabled&&"text-gray-400"}`,children:props.label})]})}));try{RadioGroup.displayName="RadioGroup",RadioGroup.__docgenInfo={description:"",displayName:"RadioGroup",props:{label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},withFormik:{defaultValue:{value:"true"},description:"",name:"withFormik",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/forms/RadioGroup.tsx#RadioGroup"]={docgenInfo:RadioGroup.__docgenInfo,name:"RadioGroup",path:"src/components/forms/RadioGroup.tsx#RadioGroup"})}catch(__react_docgen_typescript_loader_error){}try{RadioButton.displayName="RadioButton",RadioButton.__docgenInfo={description:"",displayName:"RadioButton",props:{name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/forms/RadioGroup.tsx#RadioButton"]={docgenInfo:RadioButton.__docgenInfo,name:"RadioButton",path:"src/components/forms/RadioGroup.tsx#RadioButton"})}catch(__react_docgen_typescript_loader_error){}try{RadioButtonInput.displayName="RadioButtonInput",RadioButtonInput.__docgenInfo={description:"",displayName:"RadioButtonInput",props:{label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/forms/RadioGroup.tsx#RadioButtonInput"]={docgenInfo:RadioButtonInput.__docgenInfo,name:"RadioButtonInput",path:"src/components/forms/RadioGroup.tsx#RadioButtonInput"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/pagination/Pager.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/react/index.js");var _buttons_IconButton__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/components/buttons/IconButton.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js");function Pager(_ref){let{currentPage,numberOfPages,pageDownDisabled,pageUpDisabled,onPageDownClick,onPageUpClick}=_ref;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)("div",{className:"flex flex-row items-center gap-6 text-sm text-gray-700",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_buttons_IconButton__WEBPACK_IMPORTED_MODULE_1__.A,{disabled:pageDownDisabled,dataTestId:"left-button",onClick:onPageDownClick,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)("div",{"data-testid":"pager-text-div",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("span",{className:"font-medium",children:currentPage})," of ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("span",{className:"font-medium",children:numberOfPages})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_buttons_IconButton__WEBPACK_IMPORTED_MODULE_1__.A,{disabled:pageUpDisabled,onClick:onPageUpClick,dataTestId:"right-button",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})})})]})}const __WEBPACK_DEFAULT_EXPORT__=Pager;try{Pager.displayName="Pager",Pager.__docgenInfo={description:"A pager shows how many pages are available, and allows navigation between those pages.\n\nWorks well with the {@link usePager } hook.",displayName:"Pager",props:{currentPage:{defaultValue:null,description:"The current page",name:"currentPage",required:!0,type:{name:"number"}},numberOfPages:{defaultValue:null,description:"How many pages does the pager have",name:"numberOfPages",required:!0,type:{name:"number"}},pageDownDisabled:{defaultValue:null,description:"Should the page down button be disabled",name:"pageDownDisabled",required:!0,type:{name:"boolean"}},onPageDownClick:{defaultValue:null,description:"Callback for clicking on the page down button",name:"onPageDownClick",required:!0,type:{name:"VoidFunction"}},pageUpDisabled:{defaultValue:null,description:"Should the page up button be disabled",name:"pageUpDisabled",required:!0,type:{name:"boolean"}},onPageUpClick:{defaultValue:null,description:"Callback for clicking on the page down button",name:"onPageUpClick",required:!0,type:{name:"VoidFunction"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/pagination/Pager.tsx#Pager"]={docgenInfo:Pager.__docgenInfo,name:"Pager",path:"src/components/pagination/Pager.tsx#Pager"})}catch(__react_docgen_typescript_loader_error){}},"./src/lib/hooks/usePager.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{X:()=>usePager});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js");function pagerReducer(state,action){let currentPage,numberOfPages;switch(action.type){case"PAGE_UP":return state.currentPage<state.numberOfPages?{...state,currentPage:state.currentPage+1}:state;case"PAGE_DOWN":return state.currentPage>1?{...state,currentPage:state.currentPage-1}:state;case"GO_TO_LAST_PAGE":return{...state,currentPage:state.numberOfPages};case"SET_NUMBER_OF_PAGES":return numberOfPages=action.numberOfPages,numberOfPages<0&&(numberOfPages=0),currentPage=state.currentPage,currentPage>numberOfPages?currentPage=numberOfPages:0===currentPage&&(currentPage=1),{...state,numberOfPages,currentPage};case"SET_CURRENT_PAGE":return currentPage=action.currentPage,currentPage<1?currentPage=1:currentPage>state.numberOfPages&&(currentPage=state.numberOfPages),{...state,currentPage}}return state}function usePager(_ref){let{initialCurrentPage,initialNumberOfPages}=_ref;const[state,dispatch]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useReducer)(pagerReducer,{currentPage:initialCurrentPage,numberOfPages:initialNumberOfPages}),setNumberOfPages=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((numberOfPages=>dispatch({type:"SET_NUMBER_OF_PAGES",numberOfPages})),[dispatch]),goToLastPage=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((()=>dispatch({type:"GO_TO_LAST_PAGE"})),[dispatch]),onPageUpClick=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((()=>dispatch({type:"PAGE_UP"})),[dispatch]),onPageDownClick=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((()=>dispatch({type:"PAGE_DOWN"})),[dispatch]),setCurrentPage=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((currentPage=>dispatch({type:"SET_CURRENT_PAGE",currentPage})),[dispatch]);return{...state,setCurrentPage,setNumberOfPages,goToLastPage,onPageUpClick,onPageDownClick,pageUpDisabled:state.currentPage===state.numberOfPages,pageDownDisabled:1===state.currentPage}}}}]);