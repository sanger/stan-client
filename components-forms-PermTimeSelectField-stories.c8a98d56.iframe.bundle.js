"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[142],{"./src/components/forms/PermTimeSelectField.stories.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Primary:function(){return Primary},__namedExportsOrder:function(){return __namedExportsOrder},default:function(){return PermTimeSelectField_stories}});var objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),regeneratorRuntime=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js"),asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),react=__webpack_require__("./node_modules/react/index.js"),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),useMachine=__webpack_require__("./node_modules/@xstate/react/es/useMachine.js"),lib=__webpack_require__("./node_modules/@xstate/immer/lib/index.js"),Machine=__webpack_require__("./node_modules/xstate/es/Machine.js");var createDataFetcherMachine=function createMachineBuilder(machineConfig,machineOptions){return function(params){var machine=(0,Machine.J)(machineConfig,machineOptions);if(null!=params&&params.options&&(machine=machine.withConfig(params.options)),null!=params&&params.context){var newContext=Object.assign({},machine.context,params.context);machine=machine.withContext(newContext)}return machine}}({id:"dataFetcher",initial:"loading",states:{loading:{invoke:{src:"fetchData",onDone:{target:"done",actions:(0,lib.f0)((function(ctx,e){ctx.data=e.data}))},onError:"failed"}},failed:{on:{RETRY:"loading"}},done:{type:"final"}}},{services:{fetchData:function fetchData(ctx){return ctx.dataFetcher()}}}),dataFetcher_dataFetcherMachine=createDataFetcherMachine,LoadingSpinner=__webpack_require__("./src/components/icons/LoadingSpinner.tsx"),Warning=__webpack_require__("./src/components/notifications/Warning.tsx"),WhiteButton=__webpack_require__("./src/components/buttons/WhiteButton.tsx"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");function DataLoader(_ref){var loader=_ref.loader,children=_ref.children,_ref$errorMessage=_ref.errorMessage,errorMessage=void 0===_ref$errorMessage?"There was an error while loading. Please try again.":_ref$errorMessage,dataFetcherMachine=react.useMemo((function(){return dataFetcher_dataFetcherMachine({context:{dataFetcher:loader}})}),[loader]),_useMachine=(0,useMachine.e)(dataFetcherMachine),_useMachine2=(0,slicedToArray.Z)(_useMachine,2),state=_useMachine2[0],send=_useMachine2[1],data=state.context.data;return state.matches("done")?(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:children(data)}):(0,jsx_runtime.jsxs)("div",{className:"mx-auto",children:[state.matches("loading")&&(0,jsx_runtime.jsx)(LoadingSpinner.Z,{}),state.matches("failed")&&(0,jsx_runtime.jsx)(Warning.Z,{message:errorMessage,children:(0,jsx_runtime.jsx)(WhiteButton.Z,{onClick:function onClick(){return send({type:"RETRY"})},children:"Retry"})})]})}try{DataLoader.displayName="DataLoader",DataLoader.__docgenInfo={description:"Container component that will fetch data, showing a loading spinner in the mean time.",displayName:"DataLoader",props:{loader:{defaultValue:null,description:"A function that asynchronously fetches the data",name:"loader",required:!0,type:{name:"() => Promise<E>"}},children:{defaultValue:null,description:"A function that will be passed the data once loaded",name:"children",required:!0,type:{name:"(data: E) => ReactNode"}},errorMessage:{defaultValue:{value:"There was an error while loading. Please try again."},description:"Optional: error message to display to the user if loading fails",name:"errorMessage",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/dataLoader/DataLoader.tsx#DataLoader"]={docgenInfo:DataLoader.__docgenInfo,name:"DataLoader",path:"src/components/dataLoader/DataLoader.tsx#DataLoader"})}catch(__react_docgen_typescript_loader_error){}var sdk=__webpack_require__("./src/lib/sdk.ts"),Labware=__webpack_require__("./src/components/labware/Labware.tsx"),RadioGroup=__webpack_require__("./src/components/forms/RadioGroup.tsx"),formik_esm=__webpack_require__("./node_modules/formik/dist/formik.esm.js"),helpers=__webpack_require__("./src/lib/helpers.ts");function PermTimeSelectField(_ref){var barcode=_ref.barcode;return(0,jsx_runtime.jsx)(DataLoader,{loader:function loader(){return sdk.dj.FindPermData({barcode:barcode})},children:function children(data){return(0,jsx_runtime.jsx)(PermTimeSelectFieldInner,{data:data})}})}function PermTimeSelectFieldInner(_ref2){var _data$visiumPermData$,data=_ref2.data,_useFormikContext=(0,formik_esm.u6)(),setFieldValue=_useFormikContext.setFieldValue,values=_useFormikContext.values,addressPermDataMap=(0,react.useMemo)((function(){return(0,helpers.J3)(data.visiumPermData.addressPermData,"address")}),[data]),initialSelectedAddress=null===(_data$visiumPermData$=data.visiumPermData.addressPermData.find((function(apd){return apd.selected})))||void 0===_data$visiumPermData$?void 0:_data$visiumPermData$.address;return(0,react.useEffect)((function(){initialSelectedAddress&&setFieldValue("selectedAddress",initialSelectedAddress)}),[initialSelectedAddress,setFieldValue]),(0,react.useEffect)((function(){var _addressPermDataMap$g;setFieldValue("selectedTime",null===(_addressPermDataMap$g=addressPermDataMap.get(values.selectedAddress))||void 0===_addressPermDataMap$g?void 0:_addressPermDataMap$g.seconds)}),[data,values.selectedAddress,setFieldValue,addressPermDataMap]),(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsxs)(RadioGroup.ZP,{name:"selectedAddress",label:"",children:[(0,jsx_runtime.jsx)(Labware.Z,{labware:data.visiumPermData.labware,slotBuilder:function slotBuilder(slot){var addressPermData=addressPermDataMap.get(slot.address);if(!addressPermData||!addressPermData.seconds)return null;var name="".concat(Math.floor(addressPermData.seconds/60)," minutes");return(0,jsx_runtime.jsx)(RadioGroup.EU,{name:name,value:addressPermData.address})}}),""!==values.selectedAddress&&initialSelectedAddress&&values.selectedAddress!==initialSelectedAddress&&(0,jsx_runtime.jsx)("div",{className:"mt-2",children:(0,jsx_runtime.jsx)(Warning.Z,{message:"Warning",children:"The selected perm time is being changed for this slide"})})]})})}try{PermTimeSelectField.displayName="PermTimeSelectField",PermTimeSelectField.__docgenInfo={description:"Formik input for allowing a user to select the best perm time for a slide.",displayName:"PermTimeSelectField",props:{barcode:{defaultValue:null,description:"Barcode of the labware to select a perm time from",name:"barcode",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/forms/PermTimeSelectField.tsx#PermTimeSelectField"]={docgenInfo:PermTimeSelectField.__docgenInfo,name:"PermTimeSelectField",path:"src/components/forms/PermTimeSelectField.tsx#PermTimeSelectField"})}catch(__react_docgen_typescript_loader_error){}var PermTimeSelectField_stories={title:"Forms/Formik/PermTimeSelectField",component:PermTimeSelectField},Primary=function Primary(){return(0,jsx_runtime.jsx)(formik_esm.J9,{onSubmit:function(){var _ref=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee(values){return(0,regeneratorRuntime.Z)().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",alert(JSON.stringify(values)));case 1:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref.apply(this,arguments)}}(),initialValues:{barcode:"",selectedAddress:"",selectedTime:0},children:(0,jsx_runtime.jsxs)(formik_esm.l0,{children:[(0,jsx_runtime.jsx)(PermTimeSelectField,{barcode:"STAN-311"}),(0,jsx_runtime.jsx)(WhiteButton.Z,{type:"submit",children:"Submit"})]})})};Primary.parameters=(0,objectSpread2.Z)({storySource:{source:"() => {\n  return (\n    <Formik\n      onSubmit={async (values: any) => alert(JSON.stringify(values))}\n      initialValues={{\n        barcode: '',\n        selectedAddress: '',\n        selectedTime: 0\n      }}\n    >\n      <Form>\n        <PermTimeSelectField barcode={'STAN-311'} />\n        <WhiteButton type=\"submit\">Submit</WhiteButton>\n      </Form>\n    </Formik>\n  );\n}"}},Primary.parameters);var __namedExportsOrder=["Primary"]},"./src/components/icons/BarcodeIcon.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _home_runner_work_stan_client_stan_client_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=(__webpack_require__("./node_modules/react/index.js"),__webpack_require__("./node_modules/react/jsx-runtime.js")),BarcodeIcon=function BarcodeIcon(props){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("svg",(0,_home_runner_work_stan_client_stan_client_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_2__.Z)((0,_home_runner_work_stan_client_stan_client_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_2__.Z)({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},props),{},{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}))};__webpack_exports__.Z=BarcodeIcon;try{BarcodeIcon.displayName="BarcodeIcon",BarcodeIcon.__docgenInfo={description:"Barcode SVG icon",displayName:"BarcodeIcon",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/icons/BarcodeIcon.tsx#BarcodeIcon"]={docgenInfo:BarcodeIcon.__docgenInfo,name:"BarcodeIcon",path:"src/components/icons/BarcodeIcon.tsx#BarcodeIcon"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/notifications/Warning.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _home_runner_work_stan_client_stan_client_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),_home_runner_work_stan_client_stan_client_node_modules_babel_runtime_helpers_esm_objectWithoutProperties_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),classnames__WEBPACK_IMPORTED_MODULE_1__=(__webpack_require__("./node_modules/react/index.js"),__webpack_require__("./node_modules/classnames/index.js")),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),_types_stan__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/types/stan.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react/jsx-runtime.js"),_excluded=["message","error","children","className"],Warning=function Warning(_ref){var _serverErrors,_serverErrors2,serverErrors,message=_ref.message,error=_ref.error,children=_ref.children,className=_ref.className,rest=(0,_home_runner_work_stan_client_stan_client_node_modules_babel_runtime_helpers_esm_objectWithoutProperties_js__WEBPACK_IMPORTED_MODULE_4__.Z)(_ref,_excluded),sectionClasses=classnames__WEBPACK_IMPORTED_MODULE_1___default()("flex flex-row items-start justify-between border-l-4 border-orange-600 p-2 bg-orange-200 text-orange-800",className);return error&&(serverErrors=(0,_types_stan__WEBPACK_IMPORTED_MODULE_2__.d$)(error)),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("section",(0,_home_runner_work_stan_client_stan_client_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_5__.Z)((0,_home_runner_work_stan_client_stan_client_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_5__.Z)({},rest),{},{className:sectionClasses,"data-testid":"warning",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",className:"h-6 w-6",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("div",{className:"ml-2 flex-grow",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("p",{className:"font-medium whitespace-pre-wrap",children:message}),(null===(_serverErrors=serverErrors)||void 0===_serverErrors?void 0:_serverErrors.message)&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("p",{className:"mt-2",children:serverErrors.message}),(null===(_serverErrors2=serverErrors)||void 0===_serverErrors2?void 0:_serverErrors2.problems)&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:"mt-2",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("ul",{className:"list-disc list-inside",children:serverErrors.problems.map((function(problem,index){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("li",{children:problem},index)}))})}),children&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:"mt-2",children:children})]})]}))};__webpack_exports__.Z=Warning;try{Warning.displayName="Warning",Warning.__docgenInfo={description:"",displayName:"Warning",props:{message:{defaultValue:null,description:"",name:"message",required:!1,type:{name:"string"}},error:{defaultValue:null,description:"",name:"error",required:!1,type:{name:"Maybe<ClientError>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/notifications/Warning.tsx#Warning"]={docgenInfo:Warning.__docgenInfo,name:"Warning",path:"src/components/notifications/Warning.tsx#Warning"})}catch(__react_docgen_typescript_loader_error){}},"./src/lib/sdk.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{dj:function(){return stanCore}});var graphql_request__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/graphql-request/dist/index.js"),js_cookie__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/js-cookie/dist/js.cookie.mjs"),_types_sdk__WEBPACK_IMPORTED_MODULE_3__=(__webpack_require__("./node_modules/react/index.js"),__webpack_require__("./src/types/sdk.ts")),history__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/history/esm/history.js"),graphQLClient=new graphql_request__WEBPACK_IMPORTED_MODULE_0__.GraphQLClient("/graphql"),xsrf=js_cookie__WEBPACK_IMPORTED_MODULE_1__.Z.get("XSRF-TOKEN");xsrf&&graphQLClient.setHeader("X-XSRF-TOKEN",xsrf);var stanCore=(0,_types_sdk__WEBPACK_IMPORTED_MODULE_3__.mKo)(graphQLClient);(0,history__WEBPACK_IMPORTED_MODULE_4__.lX)()}}]);